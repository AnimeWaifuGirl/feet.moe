var matrix_location,opacity_location,projection_mat,img_i=0;const img_url_list=["./bg/Image01.jpg","./bg/Image02.jpg","./bg/Image03.jpg","./bg/Image04.jpg","./bg/Image05.jpg","./bg/Image06.jpg"];var texture_info_list=[];function create_shader(a,c,d){var b=a.createShader(c);if(a.shaderSource(b,d),a.compileShader(b),a.getShaderParameter(b,a.COMPILE_STATUS))return b;console.log(a.getShaderInfoLog(b)),a.deleteShader(b)}function create_program(a,c,d){var b=a.createProgram();if(a.attachShader(b,c),a.attachShader(b,d),a.linkProgram(b),a.getProgramParameter(b,a.LINK_STATUS))return b;console.log(a.getProgramInfoLog(b)),a.deleteProgram(b)}function load_image(a,c){gl_texture=a.createTexture(),a.bindTexture(a.TEXTURE_2D,gl_texture),a.texImage2D(a.TEXTURE_2D,0,a.RGB,1,1,0,a.RGB,a.UNSIGNED_BYTE,new Uint8Array([0,0,0])),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR);var d={width:0,height:0,gl_texture:gl_texture},b=new Image;return b.addEventListener("load",function(){d.width=b.width,d.height=b.height,a.bindTexture(a.TEXTURE_2D,d.gl_texture),a.texImage2D(a.TEXTURE_2D,0,a.RGB,a.RGB,a.UNSIGNED_BYTE,b)}),b.src=c,d}function render_background(a,e,h){var d=glMatrix.mat4.create(),f=0,g=0,b=e.width,c=e.height,i=h*(b/c),j=h;b/c<a.canvas.width/a.canvas.height?(c=c*(a.canvas.width/b)+j,b=a.canvas.width+i,f=a.canvas.width/2-b/2,g=a.canvas.height/2-c/2):(b=b*(a.canvas.height/c)+i,c=a.canvas.height+j,f=a.canvas.width/2-b/2,g=a.canvas.height/2-c/2),glMatrix.mat4.translate(d,d,[f,g,0]),glMatrix.mat4.scale(d,d,[b,c,0]),glMatrix.mat4.multiply(d,projection_mat,d),a.uniformMatrix4fv(matrix_location,!1,d),a.bindTexture(a.TEXTURE_2D,e.gl_texture),a.drawArrays(a.TRIANGLES,0,6)}function on_frame(a){var b=performance.now()/1e3;a.canvas.width=a.canvas.clientWidth,a.canvas.height=a.canvas.clientHeight,a.viewport(0,0,a.canvas.width,a.canvas.height),a.clearColor(0,0,0,1),a.clear(a.COLOR_BUFFER_BIT),projection_mat=glMatrix.mat4.create(),glMatrix.mat4.ortho(projection_mat,0,a.canvas.width,a.canvas.height,0,0,.1,100),a.uniform1f(opacity_location,1),render_background(a,texture_info_list[Math.trunc(.07*b+2.5)%5],Math.pow(2e3,(.07*b+.5)%1)),a.uniform1f(opacity_location,.5*Math.sin(2*Math.PI*.07*b-1.5)+.5),render_background(a,texture_info_list[Math.trunc(.07*b)%5],Math.pow(2e3,.07*b%1)),requestAnimationFrame(function(){on_frame(a)})}window.onload=function(){let j=document.getElementById("bg"),a=j.getContext("webgl");if(!a)throw new Error("WebGL not supported");a.enable(a.BLEND),a.blendFunc(a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA);let k=`attribute vec4 a_pos; attribute vec2 a_texcoord; uniform mat4 u_matrix; varying vec2 v_texcoord; void main() { gl_Position = u_matrix * a_pos; v_texcoord = a_texcoord; }`;var d=create_shader(a,a.VERTEX_SHADER,k);if(!d)throw new Error("WebGL could not create vertex shader");let l=`precision mediump float; varying vec2 v_texcoord; uniform float f_opacity; uniform sampler2D u_texture; void main() { gl_FragColor = vec4(texture2D(u_texture, v_texcoord).rgb, f_opacity); }`;var e=create_shader(a,a.FRAGMENT_SHADER,l);if(!e)throw new Error("WebGL could not create fragment shader");var b=create_program(a,d,e);if(!b)throw new Error("WebGL could not create program");matrix_location=a.getUniformLocation(b,"u_matrix"),opacity_location=a.getUniformLocation(b,"f_opacity");var f=a.getAttribLocation(b,"a_pos"),g=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,g),a.bufferData(a.ARRAY_BUFFER,new Float32Array([0,0,0,1,1,0,1,0,0,1,1,1,]),a.STATIC_DRAW);var h=a.getAttribLocation(b,"a_texcoord"),i=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,i),a.bufferData(a.ARRAY_BUFFER,new Float32Array([0,0,0,1,1,0,1,0,0,1,1,1,]),a.STATIC_DRAW),a.useProgram(b),a.enableVertexAttribArray(f),a.bindBuffer(a.ARRAY_BUFFER,g),a.vertexAttribPointer(f,2,a.FLOAT,!1,0,0),a.enableVertexAttribArray(h),a.bindBuffer(a.ARRAY_BUFFER,i),a.vertexAttribPointer(h,2,a.FLOAT,!1,0,0);for(var c=0;c<img_url_list.length;c++)texture_info_list[c]=load_image(a,img_url_list[c]);on_frame(a)}